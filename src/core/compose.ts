import { Middleware } from './Middleware';
import { Next } from './Next';

export function compose<
  E1,
  E2,
  E3,
  E4,
  E5,
  E6,
  E7,
  E8,
  E9,
  E10,
  E11,
  E12,
  E13,
  E14,
  E15,
  R1,
  R2,
  R3,
  R4,
  R5,
  R6,
  R7,
  R8,
  R9,
  R10,
  R11,
  R12,
  R13,
  R14,
  R15,
>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
  m: Middleware<E8, E9, R8, R9>,
  n: Middleware<E9, E10, R9, R10>,
  o: Middleware<E10, E11, R10, R11>,
  p: Middleware<E11, E12, R11, R12>,
  q: Middleware<E12, E13, R12, R13>,
  r: Middleware<E13, E14, R13, R14>,
  s: Middleware<E14, E15, R14, R15>,
): Middleware<E1, E15, R1, R15, { actual: Next<E15, R15> }>;
export function compose<
  E1,
  E2,
  E3,
  E4,
  E5,
  E6,
  E7,
  E8,
  E9,
  E10,
  E11,
  E12,
  E13,
  E14,
  R1,
  R2,
  R3,
  R4,
  R5,
  R6,
  R7,
  R8,
  R9,
  R10,
  R11,
  R12,
  R13,
  R14,
>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
  m: Middleware<E8, E9, R8, R9>,
  n: Middleware<E9, E10, R9, R10>,
  o: Middleware<E10, E11, R10, R11>,
  p: Middleware<E11, E12, R11, R12>,
  q: Middleware<E12, E13, R12, R13>,
  r: Middleware<E13, E14, R13, R14>,
): Middleware<E1, E14, R1, R14, { actual: Next<E14, R14> }>;
export function compose<
  E1,
  E2,
  E3,
  E4,
  E5,
  E6,
  E7,
  E8,
  E9,
  E10,
  E11,
  E12,
  E13,
  R1,
  R2,
  R3,
  R4,
  R5,
  R6,
  R7,
  R8,
  R9,
  R10,
  R11,
  R12,
  R13,
>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
  m: Middleware<E8, E9, R8, R9>,
  n: Middleware<E9, E10, R9, R10>,
  o: Middleware<E10, E11, R10, R11>,
  p: Middleware<E11, E12, R11, R12>,
  q: Middleware<E12, E13, R12, R13>,
): Middleware<E1, E13, R1, R13, { actual: Next<E13, R13> }>;
export function compose<
  E1,
  E2,
  E3,
  E4,
  E5,
  E6,
  E7,
  E8,
  E9,
  E10,
  E11,
  E12,
  R1,
  R2,
  R3,
  R4,
  R5,
  R6,
  R7,
  R8,
  R9,
  R10,
  R11,
  R12,
>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
  m: Middleware<E8, E9, R8, R9>,
  n: Middleware<E9, E10, R9, R10>,
  o: Middleware<E10, E11, R10, R11>,
  p: Middleware<E11, E12, R11, R12>,
): Middleware<E1, E12, R1, R12, { actual: Next<E12, R12> }>;
export function compose<
  E1,
  E2,
  E3,
  E4,
  E5,
  E6,
  E7,
  E8,
  E9,
  E10,
  E11,
  R1,
  R2,
  R3,
  R4,
  R5,
  R6,
  R7,
  R8,
  R9,
  R10,
  R11,
>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
  m: Middleware<E8, E9, R8, R9>,
  n: Middleware<E9, E10, R9, R10>,
  o: Middleware<E10, E11, R10, R11>,
): Middleware<E1, E11, R1, R11, { actual: Next<E11, R11> }>;
export function compose<
  E1,
  E2,
  E3,
  E4,
  E5,
  E6,
  E7,
  E8,
  E9,
  E10,
  R1,
  R2,
  R3,
  R4,
  R5,
  R6,
  R7,
  R8,
  R9,
  R10,
>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
  m: Middleware<E8, E9, R8, R9>,
  n: Middleware<E9, E10, R9, R10>,
): Middleware<E1, E10, R1, R10, { actual: Next<E10, R10> }>;
export function compose<E1, E2, E3, E4, E5, E6, E7, E8, E9, R1, R2, R3, R4, R5, R6, R7, R8, R9>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
  m: Middleware<E8, E9, R8, R9>,
): Middleware<E1, E9, R1, R9, { actual: Next<E9, R9> }>;
export function compose<E1, E2, E3, E4, E5, E6, E7, E8, R1, R2, R3, R4, R5, R6, R7, R8>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
  l: Middleware<E7, E8, R7, R8>,
): Middleware<E1, E8, R1, R8, { actual: Next<E8, R8> }>;
export function compose<E1, E2, E3, E4, E5, E6, E7, R1, R2, R3, R4, R5, R6, R7>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
  k: Middleware<E6, E7, R6, R7>,
): Middleware<E1, E7, R1, R7, { actual: Next<E7, R7> }>;
export function compose<E1, E2, E3, E4, E5, E6, R1, R2, R3, R4, R5, R6>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
  j: Middleware<E5, E6, R5, R6>,
): Middleware<E1, E6, R1, R6, { actual: Next<E6, R6> }>;
export function compose<E1, E2, E3, E4, E5, R1, R2, R3, R4, R5>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
  i: Middleware<E4, E5, R4, R5>,
): Middleware<E1, E5, R1, R5, { actual: Next<E5, R5> }>;
export function compose<E1, E2, E3, E4, R1, R2, R3, R4>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
  h: Middleware<E3, E4, R3, R4>,
): Middleware<E1, E4, R1, R4, { actual: Next<E4, R4> }>;
export function compose<E1, E2, E3, R1, R2, R3>(
  f: Middleware<E1, E2, R1, R2>,
  g: Middleware<E2, E3, R2, R3>,
): Middleware<E1, E3, R1, R3, { actual: Next<E3, R3> }>;
// TODO Currently there is no 'actual' reference if 1 middleware is passed
// This is because of the callback passed to 'reduce' only gets called if
// more than 1 entry (in this case function) is set in the corresponding array
// -> Anyway: This should be fixed in the future
export function compose<E1, E2, R1, R2>(f: Middleware<E1, E2, R1, R2>): Middleware<E1, E2, R1, R2>;
export function compose(...fns) {
  return fns.reduce((f, g) => (handler) => Object.assign(f(g(handler)), { actual: handler }));
}
